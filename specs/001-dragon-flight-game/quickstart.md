# Quickstart: Dragon Flight Game

**Feature**: 001-dragon-flight-game
**Date**: 2026-02-09

## Prerequisites

- Node.js 20+ (LTS)
- npm 10+
- A modern browser (Chrome, Safari, Firefox)
- For iOS testing: an iOS device or macOS with Safari (Simulator)

## Setup

```bash
# Clone and enter project
cd DragonHero

# Install dependencies
npm install

# Start development server
npm run dev
```

The game will be available at `http://localhost:5173`.

## Development Commands

| Command | Description |
|---|---|
| `npm run dev` | Start Vite dev server with HMR |
| `npm run build` | Production build to `dist/` |
| `npm run preview` | Preview production build locally |
| `npm run test` | Run Vitest unit tests |
| `npm run test:e2e` | Run Playwright E2E tests |
| `npm run lint` | Run ESLint |
| `npm run format` | Run Prettier |

## Project Structure

```text
src/
├── main.ts                  # Phaser game config and entry point
├── scenes/
│   ├── BootScene.ts         # Asset preloading
│   ├── StartScene.ts        # Title screen with Start button
│   ├── IntroScene.ts        # Speech-bubble story sequence
│   ├── GameScene.ts         # Core flappy-bird gameplay
│   ├── GameOverScene.ts     # Game over with retry/menu
│   └── EndingScene.ts       # Victory ending scene
├── entities/
│   ├── Dragon.ts            # Player character (dragon + knight)
│   └── Obstacle.ts          # Top/bottom obstacle pair
├── systems/
│   ├── PhysicsSystem.ts     # Gravity, velocity, clamping
│   ├── CollisionSystem.ts   # Hit detection, invincibility
│   └── ScrollSystem.ts      # Background/obstacle scrolling
├── data/
│   ├── levels.ts            # Level definitions (obstacle layouts)
│   └── dialogue.ts          # Intro and ending story frames
├── storage/
│   └── SaveManager.ts       # IndexedDB save/load via idb
├── config/
│   ├── gameConfig.ts        # Phaser config (canvas, dimensions)
│   └── constants.ts         # Physics, timing, sizing constants
└── assets/
    ├── sprites/             # Pixel art sprite sheets
    ├── backgrounds/         # Parallax background layers
    ├── ui/                  # UI elements (buttons, hearts, bubbles)
    └── portraits/           # Character portraits for dialogue

public/
├── manifest.json            # PWA manifest (landscape, standalone)
├── sw.js                    # Service worker (generated by plugin)
└── icons/                   # PWA icons (192x192, 512x512)

tests/
├── unit/                    # Vitest unit tests
│   ├── entities/
│   ├── systems/
│   └── storage/
└── e2e/                     # Playwright E2E tests
    ├── gameplay.spec.ts
    └── navigation.spec.ts
```

## Key Configuration

### Game Canvas

The game targets landscape mode at a logical resolution of
480x320 pixels (scaled up with nearest-neighbor interpolation
to preserve pixel art crispness). Phaser's scale manager
handles fitting to the actual screen size.

### PWA Manifest (public/manifest.json)

```json
{
  "name": "DragonHero",
  "short_name": "DragonHero",
  "start_url": "/",
  "display": "standalone",
  "orientation": "landscape",
  "background_color": "#1a1a2e",
  "theme_color": "#e94560"
}
```

### Save Data

Game progress is stored in IndexedDB under the database name
`dragonhero-saves`. Save data is a JSON object (see
data-model.md for schema). Players can export/import saves
as downloadable JSON files.

## Testing Locally on iOS

1. Run `npm run build` to create the production build
2. Run `npm run preview` to serve the built files
3. Connect your iOS device to the same network
4. Open `http://<your-local-ip>:4173` in Safari on the device
5. For PWA testing: Share > Add to Home Screen

## Common Development Tasks

### Adding a new obstacle variant

1. Add sprite sheet to `src/assets/sprites/`
2. Register the asset in `BootScene.ts` preload
3. Add variant key to `Obstacle.ts` sprite mapping
4. Reference variant in level definition in `src/data/levels.ts`

### Modifying physics (gravity, flap strength)

Edit `src/config/constants.ts` — all physics values are
centralized there with descriptive names.

### Adding a new level

1. Create a new level definition in `src/data/levels.ts`
2. Add dialogue frames in `src/data/dialogue.ts` (if story)
3. Update level progression logic in `GameScene.ts`
